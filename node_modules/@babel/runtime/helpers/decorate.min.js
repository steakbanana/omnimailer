var toArray=require("./toArray");var toPropertyKey=require("./toPropertyKey");function _decorate(j,c,h,g){var f=_getDecoratorsApi();if(g){for(var b=0;b<g.length;b++){f=g[b](f)}}var a=c(function d(i){f.initializeInstanceElements(i,e.elements)},h);var e=f.decorateClass(_coalesceClassElements(a.d.map(_createElementDescriptor)),j);f.initializeClassElements(a.F,e.elements);return f.runClassFinishers(a.F,e.finishers)}function _getDecoratorsApi(){q=function q(){return g};var g={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function j(s,r){["method","field"].forEach(function(t){r.forEach(function(u){if(u.kind===t&&u.placement==="own"){this.defineClassElement(s,u)}},this)},this)},initializeClassElements:function l(s,t){var r=s.prototype;["method","field"].forEach(function(u){t.forEach(function(w){var v=w.placement;if(w.kind===u&&(v==="static"||v==="prototype")){var x=v==="static"?s:r;this.defineClassElement(x,w)}},this)},this)},defineClassElement:function h(t,r){var u=r.descriptor;if(r.kind==="field"){var s=r.initializer;u={enumerable:u.enumerable,writable:u.writable,configurable:u.configurable,value:s===void 0?void 0:s.call(t)}}Object.defineProperty(t,r.key,u)},decorateClass:function d(v,u){var t=[];var w=[];var s={"static":[],prototype:[],own:[]};v.forEach(function(x){this.addElementPlacement(x,s)},this);v.forEach(function(y){if(!_hasDecorators(y)){return t.push(y)}var x=this.decorateElement(y,s);t.push(x.element);t.push.apply(t,x.extras);w.push.apply(w,x.finishers)},this);if(!u){return{elements:t,finishers:w}}var r=this.decorateConstructor(t,u);w.push.apply(w,r.finishers);r.finishers=w;return r},addElementPlacement:function o(t,r,s){var u=r[t.placement];if(!s&&u.indexOf(t.key)!==-1){throw new TypeError("Duplicated element ("+t.key+")")}u.push(t.key)},decorateElement:function k(w,z){var t=[];var v=[];for(var B=w.decorators,x=B.length-1;x>=0;x--){var A=z[w.placement];A.splice(A.indexOf(w.key),1);var r=this.fromElementDescriptor(w);var s=this.toElementFinisherExtras((0,B[x])(r)||r);w=s.element;this.addElementPlacement(w,z);if(s.finisher){v.push(s.finisher)}var y=s.extras;if(y){for(var u=0;u<y.length;u++){this.addElementPlacement(y[u],z)}t.push.apply(t,y)}}return{element:w,finishers:v,extras:t}},decorateConstructor:function e(w,s){var y=[];for(var u=s.length-1;u>=0;u--){var x=this.fromClassDescriptor(w);var v=this.toClassDescriptor((0,s[u])(x)||x);if(v.finisher!==undefined){y.push(v.finisher)}if(v.elements!==undefined){w=v.elements;for(var t=0;t<w.length-1;t++){for(var r=t+1;r<w.length;r++){if(w[t].key===w[r].key&&w[t].placement===w[r].placement){throw new TypeError("Duplicated element ("+w[t].key+")")}}}}}return{elements:w,finishers:y}},fromElementDescriptor:function f(r){var s={kind:r.kind,key:r.key,placement:r.placement,descriptor:r.descriptor};var t={value:"Descriptor",configurable:true};Object.defineProperty(s,Symbol.toStringTag,t);if(r.kind==="field"){s.initializer=r.initializer}return s},toElementDescriptors:function m(r){if(r===undefined){return}return toArray(r).map(function(t){var s=this.toElementDescriptor(t);this.disallowProperty(t,"finisher","An element descriptor");this.disallowProperty(t,"extras","An element descriptor");return s},this)},toElementDescriptor:function i(w){var u=String(w.kind);if(u!=="method"&&u!=="field"){throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+u+'"')}var t=toPropertyKey(w.key);var s=String(w.placement);if(s!=="static"&&s!=="prototype"&&s!=="own"){throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+s+'"')}var v=w.descriptor;this.disallowProperty(w,"elements","An element descriptor");var r={kind:u,key:t,placement:s,descriptor:Object.assign({},v)};if(u!=="field"){this.disallowProperty(w,"initializer","A method descriptor")}else{this.disallowProperty(v,"get","The property descriptor of a field descriptor");this.disallowProperty(v,"set","The property descriptor of a field descriptor");this.disallowProperty(v,"value","The property descriptor of a field descriptor");r.initializer=w.initializer}return r},toElementFinisherExtras:function p(u){var r=this.toElementDescriptor(u);var t=_optionalCallableProperty(u,"finisher");var s=this.toElementDescriptors(u.extras);return{element:r,finisher:t,extras:s}},fromClassDescriptor:function c(r){var s={kind:"class",elements:r.map(this.fromElementDescriptor,this)};var t={value:"Descriptor",configurable:true};Object.defineProperty(s,Symbol.toStringTag,t);return s},toClassDescriptor:function a(u){var r=String(u.kind);if(r!=="class"){throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+r+'"')}this.disallowProperty(u,"key","A class descriptor");this.disallowProperty(u,"placement","A class descriptor");this.disallowProperty(u,"descriptor","A class descriptor");this.disallowProperty(u,"initializer","A class descriptor");this.disallowProperty(u,"extras","A class descriptor");var t=_optionalCallableProperty(u,"finisher");var s=this.toElementDescriptors(u.elements);return{elements:s,finisher:t}},runClassFinishers:function n(t,u){for(var s=0;s<u.length;s++){var r=(0,u[s])(t);if(r!==undefined){if(typeof r!=="function"){throw new TypeError("Finishers must return a constructor.")}t=r}}return t},disallowProperty:function b(t,s,r){if(t[s]!==undefined){throw new TypeError(r+" can't have a ."+s+" property.")}}};return g}function _createElementDescriptor(c){var b=toPropertyKey(c.key);var d;if(c.kind==="method"){d={value:c.value,writable:true,configurable:true,enumerable:false}}else{if(c.kind==="get"){d={get:c.value,configurable:true,enumerable:false}}else{if(c.kind==="set"){d={set:c.value,configurable:true,enumerable:false}}else{if(c.kind==="field"){d={configurable:true,writable:true,enumerable:true}}}}}var a={kind:c.kind==="field"?"field":"method",key:b,placement:c["static"]?"static":c.kind==="field"?"own":"prototype",descriptor:d};if(c.decorators){a.decorators=c.decorators}if(c.kind==="field"){a.initializer=c.value}return a}function _coalesceGetterSetter(b,a){if(b.descriptor.get!==undefined){a.descriptor.get=b.descriptor.get}else{a.descriptor.set=b.descriptor.set}}function _coalesceClassElements(f){var b=[];var e=function e(g){return g.kind==="method"&&g.key===c.key&&g.placement===c.placement};for(var d=0;d<f.length;d++){var c=f[d];var a;if(c.kind==="method"&&(a=b.find(e))){if(_isDataDescriptor(c.descriptor)||_isDataDescriptor(a.descriptor)){if(_hasDecorators(c)||_hasDecorators(a)){throw new ReferenceError("Duplicated methods ("+c.key+") can't be decorated.")}a.descriptor=c.descriptor}else{if(_hasDecorators(c)){if(_hasDecorators(a)){throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+c.key+").")}a.decorators=c.decorators}_coalesceGetterSetter(c,a)}}else{b.push(c)}}return b}function _hasDecorators(a){return a.decorators&&a.decorators.length}function _isDataDescriptor(a){return a!==undefined&&!(a.value===undefined&&a.writable===undefined)}function _optionalCallableProperty(c,a){var b=c[a];if(b!==undefined&&typeof b!=="function"){throw new TypeError("Expected '"+a+"' to be a function")}return b}module.exports=_decorate;